{% extends "sitio_publico/base.html" %}
{% load static %}

{% block content %}

<!-- HERO UNIFICADO -->
<section class="fomento-hero text-center">
  <h1 class="fw-bold mb-2">Registro Audiovisual</h1>
  <p class="text-white mb-0">Persona Jur√≠dica</p>
</section>

<div class="container mt-2">
  <div class="row justify-content-center">
    <div class="col-lg-8">

      <div class="dav-steps">
        <div class="step">1. Tipo de persona</div>
        <div class="step active">2. Completar datos y enviar</div>
      </div>

    </div>
  </div>
</div>

<div class="container py-3">
  <div class="row justify-content-center">

    <!-- INFO -->
    <div class="col-lg-4 mb-4">
      <div class="dav-card">
        <h5 class="mb-3">Datos de la persona jur√≠dica</h5>
        <p>
          Ingres√° los datos como figuran en la documentaci√≥n oficial de la entidad.<br><br>
          La informaci√≥n correcta y actualizada es esencial para validar la inscripci√≥n
          y agilizar cualquier tr√°mite administrativo.
        </p>
        <p class="mb-0">
          Al finalizar, hac√© clic en <strong>‚ÄúEnviar‚Äù</strong> para completar el registro.
          Podr√°s actualizar tus datos cuando quieras desde <em>Mi cuenta</em>.
        </p>
      </div>
    </div>

    <!-- FORMULARIO -->
    <div class="col-lg-8">
      <div class="dav-card">

        <h3 class="mb-2">Formulario de inscripci√≥n</h3>
        <p class="text-muted mb-4">
          Datos requeridos para la inscripci√≥n de Personas Jur√≠dicas.
        </p>

        <form method="post" class="row g-3">
          {% csrf_token %}

          <!-- DATOS JUR√çDICOS -->
          <div class="col-12">
            <h5>Datos de la persona jur√≠dica</h5>
          </div>

          <div class="col-md-8">
            <label class="form-label">Tipo de persona jur√≠dica</label>
            {{ form.tipo_persona_juridica }}
            {{ form.tipo_persona_juridica.errors }}
          </div>

          <div class="col-md-4">
            <label class="form-label">CUIT</label>
            {{ form.cuil_cuit }}
            <small class="text-muted">Sin espacios ni guiones.</small>
            {{ form.cuil_cuit.errors }}
          </div>

          <div class="col-md-6">
            <label class="form-label">Raz√≥n social</label>
            {{ form.razon_social }}
            {{ form.razon_social.errors }}
          </div>

          <div class="col-md-6">
            <label class="form-label">Nombre comercial</label>
            {{ form.nombre_comercial }}
            {{ form.nombre_comercial.errors }}
          </div>

          <div class="col-md-4">
            <label class="form-label">Domicilio fiscal</label>
            {{ form.domicilio_fiscal }}
            {{ form.domicilio_fiscal.errors }}
          </div>

          <div class="col-md-4">
            <label class="form-label">C√≥digo postal</label>
            {{ form.codigo_postal_fiscal }}
            {{ form.codigo_postal_fiscal.errors }}
          </div>

          <div class="col-md-4">
            <label class="form-label">Ciudad</label>
            {{ form.localidad_fiscal }}
            {{ form.localidad_fiscal.errors }}
          </div>

          <div class="col-md-8" id="otro-lugar-wrapper" style="display:none;">
            <label class="form-label">Especificar otro lugar</label>
            {{ form.otro_lugar_residencia }}
            {{ form.otro_lugar_residencia.errors }}
          </div>

          <div class="col-md-5">
            <label class="form-label">Fecha de constituci√≥n</label>
            {{ form.fecha_constitucion }}
            {{ form.fecha_constitucion.errors }}
          </div>

          <div class="col-md-7 mb-3">
            <label class="form-label">Antig√ºedad (a√±os)</label>
              <input
                type="text"
                id="antiguedad_calculada"
                class="form-control"
                readonly
              >
          </div>

          <div class="col-md-6">
            <label class="form-label">Tel√©fono</label>
            {{ form.telefono }}
            {{ form.telefono.errors }}
          </div>

          <div class="col-md-6">
            <label class="form-label">Correo electr√≥nico</label>
            {{ form.email }}
            <small class="text-muted">
              Correo para notificaciones administrativas.
            </small>
            {{ form.email.errors }}
          </div>

          <!-- DATOS FISCALES -->
          <div class="col-12 mt-4">
            <h5>Datos fiscales</h5>
          </div>

          <div class="col-md-6">
            <label class="form-label">Situaci√≥n ante el IVA</label>
            {{ form.situacion_iva }}
            {{ form.situacion_iva.errors }}
          </div>

          <div class="col-md-6">
            <label class="form-label">Actividad declarada en DGR</label>
            {{ form.actividad_dgr }}
            {{ form.actividad_dgr.errors }}
          </div>

          <!-- DATOS PROFESIONALES -->
          <div class="col-12 mt-4">
            <h5>Datos profesionales</h5>
          </div>

          <div class="col-md-6">
            <label class="form-label">√Årea de desempe√±o principal</label>
            {{ form.area_desempeno_JJPP_1 }}
            {{ form.area_desempeno_JJPP_1.errors }}
          </div>

          <div class="col-md-6">
            <label class="form-label">√Årea de desempe√±o secundaria</label>
            {{ form.area_desempeno_JJPP_2 }}
            {{ form.area_desempeno_JJPP_2.errors }}
          </div>

          <div class="col-12 mt-4">
          <h5 class="mb-3">Presencia y trabajos</h5>
          <p class="text-muted small">
          Pod√©s compartir links a tu portfolio, canales, redes profesionales o trabajos destacados.
          </p>
        </div>

          <div class="col-12">
            {{ form.portfolio_web.label_tag }}
            {{ form.portfolio_web }}
            {{ form.portfolio_web.errors }}
          </div>

          <div class="col-12">
            {{ form.canal_video.label_tag }}
            {{ form.canal_video }}
            {{ form.canal_video.errors }}
          </div>

          <div class="col-12">
            {{ form.instagram.label_tag }}
            {{ form.instagram }}
            {{ form.instagram.errors }}
          </div>

          <div class="col-12">
            {{ form.linkedin.label_tag }}
            {{ form.linkedin }}
            {{ form.linkedin.errors }}
          </div>

          <div class="col-12">
            {{ form.link_trabajo_destacado.label_tag }}
            {{ form.link_trabajo_destacado }}
            {{ form.link_trabajo_destacado.errors }}
          </div>

          <!-- BOT√ìN -->
          <div class="col-12 text-end mt-4">
            <button type="submit" class="btn btn-primary">
              Enviar
            </button>
          </div>

        </form>

      </div>
    </div>

  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
  const fechaInput = document.querySelector("#id_fecha_constitucion");
  const antiguedadInput = document.querySelector("#antiguedad_calculada");

  if (!fechaInput || !antiguedadInput) return;

  function calcularAntiguedad() {
    if (!fechaInput.value) {
      antiguedadInput.value = "";
      return;
    }

    const fecha = new Date(fechaInput.value);
    const hoy = new Date();

    let antiguedad = hoy.getFullYear() - fecha.getFullYear();
    const m = hoy.getMonth() - fecha.getMonth();

    if (m < 0 || (m === 0 && hoy.getDate() < fecha.getDate())) {
      antiguedad--;
    }

    antiguedadInput.value = antiguedad;
  }

  fechaInput.addEventListener("change", calcularAntiguedad);
});
</script>

<script>
document.addEventListener("DOMContentLoaded", function () {
  const selectLocalidad = document.querySelector("#id_localidad_fiscal");
  const wrapperOtro = document.querySelector("#otro-lugar-wrapper");

  if (!selectLocalidad || !wrapperOtro) return;

  function toggleOtroLugar() {
    if (selectLocalidad.value === "otro") {
      wrapperOtro.style.display = "block";
    } else {
      wrapperOtro.style.display = "none";
    }
  }

  // üëâ ejecutar al cargar (modo editar)
  toggleOtroLugar();

  // üëâ ejecutar al cambiar
  selectLocalidad.addEventListener("change", toggleOtroLugar);
});
</script>



{% endblock %}
